<!doctype html>
<html lang="ar">
  <head>
    <meta charset="utf-8" />
    <title>تصفح المجلدات</title>
    
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Cairo", sans-serif;

        background-color: #121212; 

        color: #e0e0e0; 

        padding-top: 20px;
      }

      .container {
        max-width: 960px;

        margin: auto;

        background-color: #1e1e1e; 

        padding: 30px;

        border-radius: 8px;

        box-shadow: 0 2px 4px rgba(255, 255, 255, 0.1); 
      }

      h1 {
        color: #20c997; 

        margin-bottom: 1rem;

        font-size: 2.5rem;

        text-align: center;
      }

      .btn {
        padding: 0.3rem 0.6rem; 

        margin: 4px; 

        border-radius: 5px;

        transition:
          background-color 0.3s ease,
          border-color 0.3s ease; 

        text-decoration: none;

        font-size: 0.9rem; 
      }

      .btn-primary {
        background-color: #0056b3; 

        border-color: #0056b3;

        color: white;
      }

      .btn-success {
        background-color: #198754; 

        border-color: #198754;

        color: white;
      }

      .btn-secondary {
        background-color: #6c757d;

        border-color: #6c757d;

        color: white;
      } 

      

      .btn-warning {
        background-color: #ffc107;

        border-color: #ffc107;

        color: #212529;
      } 

      .btn-info {
        background-color: #17a2b8;

        border-color: #17a2b8;

        color: white;
      }

      .btn-danger {
        background-color: #dc3545;

        border-color: #dc3545;

        color: white;
      }

      .btn:hover,
      .btn:focus {
        opacity: 0.9;
      }
      .alert {
        border-radius: 4px; 
        margin-bottom: 15px;
        color: #000; 
      }
      .folder,
      .file {
        padding: 10px;
        border: 1px solid #343a40; 
        border-radius: 5px;
        margin-bottom: 10px;
        display: flex; 
        align-items: center; 
        background-color: #1e1e1e;
      }

      .folder:hover,
      .file:hover {
        background-color: #333;
        opacity: 0.9;
      }
      .file-preview {
        max-width: 100px; 
        max-height: 100px;
        margin-right: 10px; 
        border: 1px solid #555; 
      }
      .mb-3 {
        margin-bottom: 1rem !important;
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="text-center mb-4">
        <i class="fas fa-folder-open"></i> تصفح المجلدات
      </h1>
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %}
      <div class="mb-4">
        {% for category, message in messages %}
        <div
          class="alert alert-{{ category }} alert-dismissible fade show"
          role="alert"
        >
          <i class="fas fa-exclamation-triangle"></i>
          {{ message }}
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="alert"
            aria-label="Close"
          ></button>
        </div>
        {% endfor %}
      </div>
      {% endif %} {% endwith %}
      <div class="mb-3">
        {% if current_path %} {% set parent_path = current_path.rsplit('/',
        1)[0] %}
        <a
          href="{{ url_for('browse', folder_path=parent_path) }}"
          class="btn btn-primary"
          ><i class="fas fa-arrow-left"></i> العودة للمجلد السابق</a
        >
        {% endif %}
      </div>
      <div class="row">
        <div class="col-md-6">
          <h4>المجلدات</h4>
          {% for folder in folders %}
          <div class="folder">
            <form
              method="post"
              action="{{ url_for('select_folder_post', folder_path=(current_path ~ '/' ~ folder) if current_path else folder) }}"
            >
              <div class="d-flex justify-content-between align-items-center">
                <span>{{ folder }}</span>
                <button type="submit" class="btn btn-success btn-sm">
                  <i class="fas fa-check"></i> اختيار هذا المجلد
                </button>
              </div>
            </form>
          </div>
          {% endfor %} {% if not folders %}
          <p>لا توجد مجلدات في هذا المسار.</p>
          {% endif %}
        </div>
        <div class="col-md-6">
          <h4>الملفات</h4>
          {% for file in files %}
          <div class="file">
            {% if file.lower().endswith(('.mp4', '.mov', '.avi', '.mkv')) %}
            <a
              href="{{ url_for('serve_video', filename=file | quote) }}"
              target="_blank"
              >{{ file }}</a
            >
            {% elif file.lower().endswith(('.jpg', '.jpeg', '.png', '.gif')) %}
            <img
              src="{{ url_for('serve_video', filename=file | quote) }}"
              class="file-preview"
            />
            <a
              href="{{ url_for('serve_video', filename=file | quote) }}"
              target="_blank"
              >{{ file }}</a
            >
            {% else %}
            <a
              href="{{ url_for('serve_video', filename=file | quote) }}"
              target="_blank"
              >{{ file }}</a
            >
            {% endif %}
          </div>
          {% endfor %} {% if not files %}
          <p>لا توجد ملفات في هذا المسار.</p>
          {% endif %}
        </div>
      </div>
      <a href="{{ url_for('index') }}" class="btn btn-secondary mt-4"
        ><i class="fas fa-home"></i> العودة إلى الصفحة الرئيسية</a
      >
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
